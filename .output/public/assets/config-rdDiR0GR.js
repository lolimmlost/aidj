import{r as s,j as e,B as U,L as y}from"./main-Jnb6I3g-.js";import{I as u}from"./input-DlDkLuiH.js";import{L as g}from"./label-C7SbFsEs.js";import{C as N,a as C,b as S,c as T}from"./card-BWKW-5Az.js";import"./index-BfcKVs0x.js";function E(){const[l,h]=s.useState({}),[d,x]=s.useState(!1),[c,n]=s.useState(null),[a,i]=s.useState(null),[p,f]=s.useState(!1);s.useEffect(()=>{fetch("/api/config",{method:"GET"}).then(r=>r.json()).then(r=>{r?.config&&h({ollamaUrl:r.config.ollamaUrl,navidromeUrl:r.config.navidromeUrl,lidarrUrl:r.config.lidarrUrl})}).catch(()=>{})},[]);const m=(r,t)=>{h(o=>({...o,[r]:t}))},j=async r=>{if(r.preventDefault(),d)return;n(null),x(!0);const t={ollamaUrl:l.ollamaUrl,navidromeUrl:l.navidromeUrl,lidarrUrl:l.lidarrUrl};try{const o=await fetch("/api/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),v=await o.json();o.ok&&v.ok?n("Configuration saved"):n(v?.error??"Save failed")}catch{n("Request failed")}finally{x(!1)}},b=async()=>{f(!0),i(null);try{const r=await fetch("/api/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test:!0})}),t=await r.json();r.ok&&t?.statuses?i(t.statuses):i({ollamaUrl:"unreachable",navidromeUrl:"unreachable",lidarrUrl:"unreachable"})}catch{i({ollamaUrl:"unreachable",navidromeUrl:"unreachable",lidarrUrl:"unreachable"})}finally{f(!1)}};return e.jsx("div",{className:"container mx-auto p-6 max-w-2xl",children:e.jsxs(N,{children:[e.jsx(C,{children:e.jsx(S,{className:"text-3xl font-bold tracking-tight",children:"Service Configuration"})}),e.jsxs(T,{className:"space-y-6 pt-6",children:[e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"ollamaUrl",children:"Ollama URL"}),e.jsx(u,{id:"ollamaUrl",name:"ollamaUrl",type:"url",placeholder:"http://localhost:11434",value:l.ollamaUrl??"",onChange:r=>m("ollamaUrl",r.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"navidromeUrl",children:"Navidrome URL"}),e.jsx(u,{id:"navidromeUrl",name:"navidromeUrl",type:"url",placeholder:"http://localhost:4533",value:l.navidromeUrl??"",onChange:r=>m("navidromeUrl",r.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"lidarrUrl",children:"Lidarr URL"}),e.jsx(u,{id:"lidarrUrl",name:"lidarrUrl",type:"url",placeholder:"http://localhost:8686",value:l.lidarrUrl??"",onChange:r=>m("lidarrUrl",r.target.value)})]}),e.jsx(U,{type:"submit",className:"w-full",size:"lg",disabled:d,children:d?"Saving...":"Save Configuration"})]}),c&&e.jsx("div",{className:`text-sm text-center p-3 rounded-md ${c.includes("saved")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:c}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{type:"button",className:"w-full",variant:"outline",onClick:b,disabled:p,children:p?"Testing Connections...":"Test Service Connections"}),a&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium mb-1",children:"Ollama"}),e.jsx("div",{className:`text-sm px-2 py-1 rounded ${a.ollamaUrl==="connected"?"bg-green-100 text-green-800":a.ollamaUrl==="not configured"?"bg-gray-100 text-gray-600":"bg-red-100 text-red-800"}`,children:a.ollamaUrl||"Not configured"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium mb-1",children:"Navidrome"}),e.jsx("div",{className:`text-sm px-2 py-1 rounded ${a.navidromeUrl==="connected"?"bg-green-100 text-green-800":a.navidromeUrl==="not configured"?"bg-gray-100 text-gray-600":"bg-red-100 text-red-800"}`,children:a.navidromeUrl||"Not configured"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium mb-1",children:"Lidarr"}),e.jsx("div",{className:`text-sm px-2 py-1 rounded ${a.lidarrUrl==="connected"?"bg-green-100 text-green-800":a.lidarrUrl==="not configured"?"bg-gray-100 text-gray-600":"bg-red-100 text-red-800"}`,children:a.lidarrUrl||"Not configured"})]})]})]}),e.jsx("div",{className:"text-center pt-4 border-t",children:e.jsx(y,{to:"/dashboard",className:"text-primary hover:underline",children:"‚Üê Back to Dashboard"})})]})]})})}export{E as component};
